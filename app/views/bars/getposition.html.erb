<!DOCTYPE html>
<html lang="ja">
<head>
<script src=<%=@url%>></script> 
</head>

<p><button onclick="getMyPlace()">現在位置を取得</button></p>
<div id="result"></div>
<div id="map" style="width:100%;height:300px;"></div>
<script>

function getMyPlace() {
  var output = document.getElementById("result");
  if (!navigator.geolocation){//Geolocation apiがサポートされていない場合
    output.innerHTML = "<p>Geolocationはあなたのブラウザーでサポートされておりません</p>";
    return;
  }
  function success(position) {
    var latitude  = position.coords.latitude;//緯度
    var longitude = position.coords.longitude;//経度
    output.innerHTML = '<p>緯度 ' + latitude + '° <br>経度 ' + longitude + '°</p>';
    $.ajax({
    url: "/bars/index",
    type: "GET",
    data: {latitude: latitude, longitude: longitude},
    datatype: "html",
    success: function(data){
      //成功時の処理
      alert("success");
    },
    error: function(data){
      //失敗時の処理
      alert("error!");  
    }
  });
  };
  function error() {
    //エラーの場合
    output.innerHTML = "座標位置を取得できません";
  };
  navigator.geolocation.getCurrentPosition(success, error);//成功と失敗を判断
}
</script>

